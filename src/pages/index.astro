---
import Base from "../layouts/Base.astro";
import Sidebar from "../components/Sidebar.astro";

// Carga y ordena los posts (más recientes primero)
const posts = await Astro.glob("./blog/*.md");
posts.sort((a,b) => new Date(b.frontmatter.pubDate) - new Date(a.frontmatter.pubDate));
const latest = posts.slice(0, 6); // muestra los 6 últimos
---
<Base title="bulw4rk" description="Offensive tradecraft after dark.">
  <div class="two-col">
    <div class="sidebar"><Sidebar /></div>

    <section>
      <h1>Recent posts</h1>
      <ul class="post-list">
        {latest.map(p => (
          <li class="post-item">
            <h3><a href={p.url}>{p.frontmatter.title}</a></h3>
            {p.frontmatter.description && <p class="muted">{p.frontmatter.description}</p>}
            <small class="muted">
              {new Date(p.frontmatter.pubDate).toLocaleDateString()}
            </small>
          </li>
        ))}
      </ul>

      <p style="margin-top:12px">
        <a href="/blog/">View all posts →</a>
      </p>
    </section>
  </div>
</Base>
